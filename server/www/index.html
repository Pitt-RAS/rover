<!DOCTYPE html>
<html>
<head>
<script>
var ws_keys = new WebSocket('ws://192.168.1.5/keysocket');
ws_keys.onmessage = function(e) {
    console.log(e.data);
    if (e.data == 'send_input') {
        ws_keys.send(JSON.stringify(keys));
    }
};

var ws_orientation = new WebSocket('ws://192.168.1.5/phonesocket');
ws_orientation.onmessage = function(e) {
    console.log(e.data);
    if (e.data == 'send_input') {
        ws_orientation.send(JSON.stringify(keys));
    }
};

var keycodes = {
    '37': 'left',
    '38': 'up',
    '39': 'right',
    '40': 'down'
};

var keys = {
    'up': false,
    'down': false,
    'left': false,
    'right': false
};

var odata = {
    'absolute': -1,
    'alpha': -1,
    'beta': -1,
    'gamma': -1
};

function init() {
    window.addEventListener('deviceorientation', function(e) {
        odata.absolute = e.absolute;
        odata.alpha = e.alpha;
        odata.beta = e.beta;
        odata.gamma = e.gamma;
    });
    document.addEventListener('keydown', function(e) {
        keys[keycodes[''+e.keyCode]] = true;
    });
    document.addEventListener('keyup', function(e) {
        keys[keycodes[''+e.keyCode]] = false;
    });
}
</script>
</head>
<body onload="init()">
    <table>
        <tr>
            <td>
                <img src="192.168.1.5:8090/?action=stream" />
            </td>
            <td>
                <img src="192.168.1.5:8090/?action=stream" />
            </td>
        </tr>
    </table>
</body>
</html>
